---
id: 524
title: CAN-драйвер
date: 2013-10-24T06:31:26+00:00
author: catethysis
layout: post
guid: http://catethysis.ru/?p=524
permalink: /can-driver/
notely:
  - 
  - 
  - 
wp_noextrenallinks_mask_links:
  - 0
  - 0
  - 0
ratings_users:
  - 2
  - 2
  - 2
ratings_score:
  - 10
  - 10
  - 10
ratings_average:
  - 5
  - 5
  - 5
dsq_thread_id:
  - 2726264173
categories:
  - Электроника
tags:
  - CAN
  - автоэлектроника
  - электроника
---
[CAN](http://catethysis.ru/index.php/%d1%88%d0%b8%d0%bd%d0%b0-can/ "Шина CAN") &#8212; удобная и неприхотливая быстрая среда передачи данных. Применяется везде где нужна помехозащищённость и простота использования. Однако для неё обязателен драйвер среды, который мы сейчас и сделаем.

<!--more-->

Используем стандартную микросхему PCA82C250 &#8212; дешёвый и доступный драйвер. Однако очень многие драйверы CAN делаются похожими друг на друга &#8212; корпус, расположение ножек, настройки и прочее &#8212; так что вы сможете поставить вместо этой микросхемы любую другую, например TJA1050.

Для начала, нужно обеспечить защиту от помех в линии. Для этого используем два синфазных дросселя в одном корпусе, они создадут препятствие для коротких высоковольтных импульсов, которые могли навестись от системы зажигания автомобиля. Чтобы обеспечить эти импульсам короткий путь на землю, посадим обе линии CAN (CANH и CANL) на локальную землю CAN. Эта земля не должна иметь контакта с землёй устройства, разве что через дополнительный дроссель.

Чтобы защитить входы микросхемы от более мощных высоковольтных импульсов, которые всё-таки прошли через дроссель, посадим обе линии CAN на землю через сапрессор. Удобно использовать сдвоенные в одном корпусе сапрессоры на 20 вольт.

Если ваша сеть предполагает эксплуатацию в более мягких условиях &#8212; все эти защиты можно не ставить.

Далее &#8212; вход в микросхему драйвера. Подключаем линии CAN на контакты CANH и CANL микросхемы. Драйвер имеет настройку slope rate &#8212; скорость роста и спада напряжения. Подключим эту ножку через резистор на землю, как указано в даташите.

Питать микросхему драйвера будем от локального питания CAN. Линии интерфейса CAN (TxD и RxD) развяжем с помощью оптопар.

Так, мы имеем два уровня земли в драйвере, а передачу питания сделаем с помощью изолированных DC-DC конвертеров &#8212; со стороны МК в сеть CAN или наоборот, в зависимости от ваших задач.

[<img class="alignnone size-full wp-image-1955" src="http://catethysis.ru/wp-content/uploads/2013/10/can.png" alt="can" width="911" height="423" />](http://catethysis.ru/wp-content/uploads/2013/10/can.png)

Дальше подключаем всё это в [микроконтроллер](http://catethysis.ru/index.php/stm32-%d0%b8-can-%d1%88%d0%b8%d0%bd%d0%b0/ "STM32 и CAN-шина").
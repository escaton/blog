---
id: 2707
title: Вставка файлов в прошивку
date: 2015-09-14T01:16:20+00:00
author: Catethysis
layout: post
guid: http://catethysis.ru/?p=2707
permalink: /inserting_files_to_firmware/
ratings_users:
  - 2
ratings_score:
  - 10
ratings_average:
  - 5
wp_noextrenallinks_mask_links:
  - 0
dsq_thread_id:
  - 4126656725
categories:
  - STM32
---
Часто бывает нужно использовать в прошивке какой-то файл: картинку, музыку, набор файлов для создания веб-страницы, а иногда и ещё одну прошивку.

Есть программы вроде bin2h, но по-моему скачивать программу на один раз неудобно. Поэтому я написал [онлайн-сервис](http://catethysis.ru/calculators/ "Калькуляторы") для конвертирования бинарных файлов в сишный header.

## Принцип работы конвертера

Работает всё очень просто. загружаете файл, выбираете ширину слова данных (можно выбрать 1, 2 или 4 байта), смотрите в текстовом поле как будет выглядеть файл, и скачиваете готовый хедер себе. В текстовом поле отображается только первые символы файла, потому что объём хедера может достигать десятков мегабайт. Довольно тяжело отобразить такой объём в браузере, поэтому скачивайте файл.

[<img class="alignnone size-full wp-image-2716" src="http://catethysis.ru/wp-content/uploads/2015/09/generator.png" alt="generator" width="845" height="362" />](http://catethysis.ru/wp-content/uploads/2015/09/generator.png)

Например, бинарный файл <7c f0 00 20 61 ef 01 00 65 e8 01 00 6d e8 01 00 75 e8 01 00 75> мой сервис превратит в

<pre>char data[] = {0x7C, 0xF0, 0x00, 0x20, 0x61, 0xEF, 0x01, 0x00, 0x65, 0xE8, 0x01, 0x00, 0x6D, 0xE8, 0x01, 0x00, 0x75, 0xE8, 0x01, 0x00, 0x75}</pre>

Теперь можно либо скопировать текст файла в вашу программу, либо подключить файл директивой #include.

В заключение хочу сказать что для этих целей можно использовать SD-карту, но это не очень удобно, особенно в массовом производстве. SD-разъём и карта стоят денег, на них нужно отдельно закачивать данные, они требуют использования библиотек для работ с картой и файловой системой.
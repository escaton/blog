---
id: 952
title: Безопасность во встраиваемых системах / электроника
date: 2014-02-16T19:02:45+00:00
author: catethysis
layout: post
guid: http://catethysis.ru/?p=952
permalink: /embedded_security-1-electronics/
notely:
  - 
  - 
  - 
wp_noextrenallinks_mask_links:
  - 0
  - 0
  - 0
ratings_users:
  - 2
  - 2
  - 2
ratings_score:
  - 10
  - 10
  - 10
ratings_average:
  - 5
  - 5
  - 5
dsq_thread_id:
  - 2732591845
categories:
  - Электроника
tags:
  - безопасность
  - электроника
---
<span style="font-family: 'Source Sans Pro', Helvetica, sans-serif; font-size: 16px; line-height: 1.5;">Несколько слов об общей безопасности эмбеда. Разрабатывая девайсы для дома, электронщики часто пренебрегают множеством вещей, которые кажутся им лишними и &#171;слишком специализированными&#187;. К сожалению, к ним относится и чтение errata &#8212; в том числе и потому что у некоторых производителей файлы ерраты не стандартизированы и неудобны для изучения. Хотя к чести других производителей, например ST, стоит признать что еррату они выделяют ярче и размещают выше, чем даташит &#8212; и даже снабжают призывной надписью.</span>

<!--more-->

## Незамеченные ограничения

Но страшно даже не это. Страшно непонимание процессов, происходящих в коде и электронике, и игнорирование ограничений (кстати, описанных в даташитах). Чего стоит только то, что EEPROM нынче пихают везде, куда ни попадя &#8212; забывая про естественный лимит на количество записей, обусловленный физикой процесса записи в такую память. В итоге получаем <a target="_blank" rel="nofollow" href="http://catethysis.ru/goto/http://monitor.espec.ws/section33/topic71952.html" >мониторы</a> и <a target="_blank" rel="nofollow" href="http://catethysis.ru/goto/http://www.viksha.ru/audi_chorus.htm" >магнитолы</a>, в которых значение яркости (или громкости) пишется в EEPROM при каждом изменении яркости &#8212; в том числе, прямо в процессе регулирования её в меню. Натурально, изменили яркость с 100 до 0 и обратно до 100 &#8212; двести раз обновили значение в одной ячейке памяти. С годами ресурс ячейки (смешные 10 тысяч записей) вырабатывается, и монитор начинает показывать всегда на 50% яркости. Вот ещё один <a target="_blank" rel="nofollow" href="http://catethysis.ru/goto/http://kazus.ru/forums/showthread.php?t=106671&page=5" >пример</a>.

&#171;EEPROM дешёвые &#8212; почему бы их не использовать?&#187; &#8212; я думаю, это лежит в нашем менталитете. Даже если хочется сделать дешевле &#8212; тогда нужно предусмотреть механизмы равномерного износа ячеек.

<pre><em>Я бы сделал так: делим всю память на маленькие "страницы". В нулевом байте EEPROM лежит смещение текущей страницы памяти, сначала это 0. По мере износа (допустим, после примерно двух-трёх-десяти тысяч записей) инкрементируем смещение страницы и начинаем использовать следующую страницу. Так будет достигнут более-менее равномерный износ - правда, непонятно где хранить износ текущей страницы. Возможно, его можно хранить в первом байте самой страницы, или проще - инкрементировать по времени, допустим раз в месяц-полгода.</em></pre>

## Запредельные режимы работы

Туда же излюбленное использование компонентов в запредельных режимах. Ни один фирменный (т.е. не китайский) полевой транзистор не сгорит, если его использовать в документированном режиме. Если же он сгорел &#8212; это полностью ваша вина. Может быть, превышен не ток или напряжение, а временнЫе характеристики, вроде скорости нарастания этих параметров. Или не учли ёмкость Миллера, или индуктивность выводов. Забывают даже про внутренний диод. И ведь самое главное &#8212; это всё есть в даташитах или аппноутах (да, иногда действительно полезные вещи прячут в аппноуты), нужно только им следовать и проверять свои произведения искусства на полное соответствие им.

## Ну и наконец, питание

Хорошее питание &#8212; притча во языцех. Не экономьте на качественных конденсаторах &#8212; электролитах, танталах (только не забывайте об областях их применимости), керамике, и даже плёнке.

  * Танталы очень легко пробить немного повышенным напряжением &#8212; они не так стойки, как электролиты. К тому же, при пробивании они взрываются с искрами и горячими каплями.
  * Электролиты содержат жидкость, поэтому склонны к замерзанию и высыханию. При пробивании высоким напряжением с них просто срывает корпус, иногда с вылетанием ленточных обкладок.
  * SMD-керамические конденсаторы часто делают на дешёвой сегнетокерамике. Она хороша высокой диэлектрической константой, но мало кто знает что ёмкость такого конденсатора очень сильно зависит от напряжения. Этого недостатка лишены другие диэлектрики, но такие конденсаторы и стоят дороже.
  * Плёнку можно пробить, но она обладает свойством самолечения &#8212; с пробитого участка испаряется металл обкладок, цепь разрывается и конденсатор снова продолжает работать с крайне незначительным уменьшением ёмкости. Правда, тонкое напыление обкладок сильно ограничивает предельный ток.

Разделяйте силовую, аналоговую и цифровую землю, следите за путями тока в них и между ними. Цифровую землю в некоторых случаях тоже стоит разделить на чистую и грязную.

<span style="line-height: 1.5;">Короче, узкий специалист подобен флюсу, и разрабатывая электронику нельзя забывать про физику. Пока развитие не дошло до полной абстракции от физических ограничений &#8212; нам придётся держать в голове полную картину происходящего, но именно это и будет отличать нас от мартышек с паяльником.</span>

[Безопасность во встраиваемых системах / программа](http://catethysis.ru/index.php/%d0%b1%d0%b5%d0%b7%d0%be%d0%bf%d0%b0%d1%81%d0%bd%d0%be%d1%81%d1%82%d1%8c-%d0%b2%d0%be-%d0%b2%d1%81%d1%82%d1%80%d0%b0%d0%b8%d0%b2%d0%b0%d0%b5%d0%bc%d1%8b%d1%85-%d1%81%d0%b8%d1%81%d1%82%d0%b5%d0%bc/ "Безопасность во встраиваемых системах / программа")
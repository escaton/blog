---
id: 230
title: Тег-ориентированная файловая система — архитектура
date: 2013-09-20T07:37:03+00:00
author: catethysis
layout: post
guid: http://catethysis.ru/?p=230
permalink: /tagged-fs-2/
ratings_users:
  - 1
  - 1
  - 1
ratings_score:
  - 5
  - 5
  - 5
ratings_average:
  - 5
  - 5
  - 5
wp_noextrenallinks_mask_links:
  - 0
dsq_thread_id:
  - 2726263437
categories:
  - Программирование
tags:
  - теговая фс
---
[Вступление](http://catethysis.ru/?p=228 "Тег-ориентированная файловая система")

Окей, у нас вырисовывается архитектура системы:

  * Фотографии хранятся с именем GUID
  * Все фотографии имеют три версии &#8212; большое разрешение (начальное), среднее (для просмотра), и маленькое (для каталога) &#8212; с именами GUID\_b.jpg, GUID\_m.jpg и GUID_s.jpg.
  * Информация о фотографиях хранится в базе данных в 3 нормальной форме &#8212; в трёх таблицах:

  1. Список фотографий;
  2. Список всевозможных тегов;
  3. Список номеров тегов к каждой фотографии.

При добавлении новой фотографии складываем запись в таблицу фотографий с её идентификатором — GUID. При указании тега проверяем наличие его в таблице тегов, и если его нет — добавляем. После всего этого в таблицу &#171;фотография–тег&#187; добавляем n=n_тегов записей &#171;ID записи — GUID — номер тега&#187;.

### Выборка данных

Выборку данных будем делать SQL-запросом, объединяя все три таблицы.